
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>0x743</title>

<LINK REL="SHORTCUT ICON" HREF="/favicon.ico" type="image/x-icon">
<LINK REL="ICON"          HREF="/favicon.ico" type="image/x-icon">

<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">

<link rel="stylesheet" href="http://www.0x743.com/style.css" type="text/css">

<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-1688064-1";
urchinTracker();

		if (top.location!= self.location) {
			top.location = self.location.href
		}

</script>
<style>
#vee { overflow: auto; width: 100%; height: 2000px; border: dashed }
</style>

</head>
<body>

<table cellpadding="5" width=80% align=center>
<tr><td valign="top" width="100">
      <table WIDTH="145" BORDER="0" CELLSPACING="0" CELLPADDING="5">
        <tr> <td class="menuheading">Menu</td> </tr> <tr>
	  <td class="leftmenu" nowrap>
            ~~~~Main<br/>
            <a href=http://www.0x743.com>Home</a><br>
            <a href=http://www.0x743.com/contact.php>Contact</a><br/>

            <p/>~~~~Projects<br/>
            <a href=http://www.0x743.com/vee>vee</a><br/>
            <a href=http://www.patchlodge.com/x/computermeritbadge>Computer Merit Badge</a><br/>
            <a href=http://www.patchlodge.com>PatchLodge.com</a><br/>
            <a href=http://www.0x743.com/projects>Projects Summary</a><br/>

            <p/>~~~~My Bookmarks<br/>
            <a href=http://acm.lsu.edu/wiki/Resources>ACM@LSU CS Resources</a><br/>
            <a href=http://share.xmarks.com/folder/bookmarks/JVB1K4n8vD>Programming</a><br/>
            <a href=http://share.xmarks.com/folder/bookmarks/3FOmEcDzqY>Operating Systems</a><br/>
            <a href=http://share.xmarks.com/folder/bookmarks/jdvNK7PRGf>Computer Architecture</a><br/>
            <a href=http://share.xmarks.com/folder/bookmarks/Sz3sD6C2YU>Databases</a><br/>
            <br/>
          </td>
        </tr>
      </table>
</td>
<td valign="top" width="100%">

<!-- SiteSearch Google -->
<form method="get" action="http://www.google.com/custom" target="_top">
<table border="0">
<tr><td nowrap="nowrap" valign="top" align="left" height="32">
</td>
<td nowrap="nowrap">
<input type="hidden" name="domains" value="www.0x743.com"></input>
<label for="sbi" style="display: none">Enter your search terms</label>
<input type="text" name="q" size="31" maxlength="255" value="" id="sbi"></input>
<label for="sbb" style="display: none">Submit search form</label>
<input type="submit" name="sa" value="Search" id="sbb"></input>
</td></tr>
<tr>
<td>&nbsp;</td>
<td nowrap="nowrap">
<table>
<tr>
<td>
<input type="radio" name="sitesearch" value="" id="ss0"></input>
<label for="ss0" title="Search the Web"><font size="-1" color="#000000">Web</font></label></td>
<td>
<input type="radio" name="sitesearch" value="www.0x743.com" checked id="ss1"></input>
<label for="ss1" title="Search www.0x743.com"><font size="-1" color="#000000">www.0x743.com</font></label></td>
</tr>
</table>
<input type="hidden" name="client" value="pub-2603268298460480"></input>
<input type="hidden" name="forid" value="1"></input>
<input type="hidden" name="ie" value="ISO-8859-1"></input>
<input type="hidden" name="oe" value="ISO-8859-1"></input>
<input type="hidden" name="safe" value="active"></input>
<input type="hidden" name="cof" value="GALT:#0066CC;GL:1;DIV:#000000;VLC:336633;AH:center;BGC:FFFFFF;LBGC:ffffff;ALC:0066CC;LC:0066CC;T:000000;GFNT:666666;GIMP:666666;FORID:1"></input>
<input type="hidden" name="hl" value="en"></input>
</td></tr></table>
</form>
<!-- SiteSearch Google -->
<!-- content -->
<pre>

Tue Nov 15 09:12:39 CST 2011

[vee] rebuild index from .raw files

--

I accidentally deleted by HTML index of vee posts, so I took this
as an opportunity to create the first utility I've for vee  in  a
long time. I've been wanting to do index based stuff for a while,
and this is a good start.

The script is to be run at the same level as the .vee  directory.
It  loops  through an ordered list (newest to oldest) of the .raw
files, extracts the title and date from the .raw header. It  then
converts  the  extracted date to the epoch for HTML index sorting
purposes, and dumps out the HTML index.

Because some of my old posts had a different  timezone  than  the
server  I  am  on  currently, I had to jump through some hoops to
change the old TZ to the server's current TZ.  I  found  that  if
there was a mismatch, then the date utility would fail.  If there
is a slicker way to do this, then I am all ears.

I did this using utilities available on FreeBSD 7.4, so this  may
not  work out of the box on Linux. It uses the "-j" flag in date,
which I believe deviates from the POSIX date util standard.

Here's a listing of the script as of this writing, but I will  be
adding it to Github shortly, and that will be the definitive ver-
sion.

Enjoy!

<pre>

#!/bin/sh

#-- script to rebuild index based on .raw files in .vee/ created out of necessity, but
#-- provides a good example of how to do some indexed based stuff and read the basic
#-- formate in the .raw files

GENDATE=`date`
VEEDIR=./.vee
HTMLEXT=html

echo "&lt;!-- ;1000000000000000000000000; initial HTML --&gt;"
echo "&lt;!-- ;100000000000000000000000; more HTML --&gt;"
echo "&lt;!-- ;10000000000000000000000; new index regenerated on $GENDATE --&gt;"

for f in `ls -1 $VEEDIR/*.raw | sort -t. -nr`;
do
    # title is the 3rd line
    TITLE=`head -n 3 $f | tail -n 1`

    # full date string (not epoch) is the first line
    DATE=`head -n 1 $f`

    # deal with with timezone info in a brutish way (seems like a TZ mismatch in data input will cause error)
    TZ_SYS=`date "+%Z"`
    TZ_DATE=`echo $DATE | awk '{ print $5 }'`
    DATE=`echo $DATE | sed -e "s/$TZ_DATE/$TZ_SYS/"`

    # reformate date for indexing purposes (.raw files untouched)
    FORMATTED_DATE=`date -j -f "%a %b %d %T %Z %Y" "$DATE" "+%Y-%m-%d"`

    # get epoch for purpose of adding reasonable post index numbers
    EPOCH=`date -j -f "%a %b %d %T %Z %Y" "$DATE" "+%s"`

    # extract base name of .raw file so we can link to html file of same base
    FILENAME=$(basename $f)
    BASENAME=${FILENAME%.*}
    # output HTML index (can be modified to output in whatever format)
    echo "&lt;!-- ;$EPOCH; --&gt;$FORMATTED_DATE &lt;a href=$VEEDIR/$BASENAME.$HTMLEXT&gt;$TITLE&lt;/a&gt;&ltbr/&gt"
done

echo "&lt;!-- ;2; closing --&gt;"
echo '&lt;!-- ;1; closing --&gt;Powered by &lt;a href="http://www.0x743.com/vee"&gt;vee&lt;/a&gt;'
echo "&lt;!-- ;0; closing --&gt;"
</pre>

--
Powered by <a href="http://www.0x743.com/vee">vee</a><br/>Copyright &copy; 2006-2011
<!-- content -->
</td>
<td valign="top">
      <table WIDTH="145" BORDER="0" CELLSPACING="0" CELLPADDING="5">
        <tr> <td class="menuheading">Links</td> </tr>
        <tr> 
          <td class="rightmenu">
            <!-- right top menu -->
            <a href="http://www.freebsd.org">FreeBSD</a></br/>
            <a href="http://www.perl.org">Perl</a></br/>
            <a href="http://www.qore.org">Qore</a>
          </td>
        </tr>
      </table>
</td>
</tr>
</table>

</td>
</tr>
</table>

</body>
</html>
